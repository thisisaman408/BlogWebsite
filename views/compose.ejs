<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Compose</title>

    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body>
    <%- include('partials/header'); -%>
    <h1>Compose</h1>
    <form action="/compose" method="post">
      <label for="heading">Title</label>
      <input id="heading" type="text" name="heading" />
      <br />
      <br />
      <label for="composetext">How was your day?</label>
      <textarea
        name="composetext"
        id="composetext"
        placeholder="Type here..."
      ></textarea>
      <input id="index" type="hidden" name="index" />
      <button id="publish" class="btn btn-primary" type="submit">
        Publish
      </button>
    </form>

    <%- include('partials/footer'); -%>
    <script>
      // Initial counter value for `i`
      let i = 0;

      // Function to adjust textarea size
      const textarea = document.getElementById("composetext");
      textarea.addEventListener("input", adjustSize);
      function adjustSize() {
        this.style.height = "auto";
        this.style.height = this.scrollHeight + "px";
        if (
          this.scrollHeight > parseInt(window.getComputedStyle(this).maxHeight)
        ) {
          this.style.overflowY = "scroll";
        } else {
          this.style.overflowY = "hidden";
        }
      }

      // Update `i` on each publish click
      document.querySelector("#publish").addEventListener("click", (event) => {
        i++; // Increment the value of `i`
        document.querySelector("#index").value = i; // Set the incremented value to the hidden field
        console.log("Current value of i:", i); // Log the current value
      });
    </script>
  </body>
</html>
